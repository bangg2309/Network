package split;

import java.io.BufferedInputStream;
import java.io.BufferedOutputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;

public class SplitAndJoin {

	private static String makeFileName(String fileName, int order) {
		String str = "";
		if (order < 10) {
			str = ".00" + order;
		} else if (order < 100) {
			str = ".0" + order;
		} else {
			str = "" + order;
		}
		return fileName + str;
	}

	public static void splitFile(String sFile, int size) throws IOException {
		File file = new File(sFile);
		int order = 0;
		String childFile = file.getAbsolutePath();
		BufferedInputStream bis = new BufferedInputStream(new FileInputStream(sFile));
		boolean rs = false;
		do {
			order++;
			childFile = makeFileName(childFile, order);
			BufferedOutputStream bos = new BufferedOutputStream(new FileOutputStream(childFile));
			rs = tranferTo(bos, bis, size);
			bos.close();
		} while (rs);
		bis.close();
	}

	private static boolean tranferTo(BufferedOutputStream bos, BufferedInputStream bis, int size) throws IOException {
		byte[] buff = new byte[1024];
		int remainder = size;
		int readed;
		int data;
		while (remainder > 0) {
			readed = remainder < buff.length ? remainder : buff.length;
			data = bis.read(buff, 0, readed);
			if (data == -1) {
				return false;
			}
			bos.write(buff, 0, data);
			remainder -= data;
		}
		return true;
	}

	public static void joinFile() {

	}

	public static void main(String[] args) {

	}
}
