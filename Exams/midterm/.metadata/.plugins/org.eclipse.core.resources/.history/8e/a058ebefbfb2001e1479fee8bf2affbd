import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;

public class SplitAndJoinFile {

	private String makeDestFileName(String sourceFile, int order) {
		String ext;
		if (order < 10) {
			ext = ".00" + order;
		} else if (order < 100) {
			ext = ".0" + order;
		} else {
			ext = "." + order;
		}
		return sourceFile + order;
	}

	public void splitFile(String sourceFile, int size) throws FileNotFoundException {
		FileInputStream fis = new FileInputStream(sourceFile);
		String destFile;
		FileOutputStream fos;
		boolean rs = false;
		int order = 0;

		do {
			destFile = makeDestFileName(sourceFile, order);
			order++;
			fos = new FileOutputStream(destFile);
			rs = tranferTo(fis, fos, size);
		} while (rs);

	}

	private boolean tranferTo(FileInputStream fis, FileOutputStream fos, int size) throws IOException {
		byte[] buff = new byte[1024];
		int remain = size;
		int data;
		int readed;
		while (remain > 0) {
			data = remain < buff.length ? remain : buff.length;
			 readed = fis.read(buff, 0, data);
			 if (readed == -1) {
				return false;
			}
			 fos.write(readed);
			 remain = -= readed;
		}
		return false;
	}
}
