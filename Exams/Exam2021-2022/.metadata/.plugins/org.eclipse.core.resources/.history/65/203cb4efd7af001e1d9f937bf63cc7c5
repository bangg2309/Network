package server;

import java.io.File;
import java.io.IOException;
import java.io.RandomAccessFile;

public class Service {
	private RandomAccessFile raf;
	public static final String URL = "D:\\Project\\Network\\Exams\\Exam2021-2022\\RAF\\DATA\\thisinh.dat";

	public Service() throws IOException {
		File file = new File(URL);
		if (!file.exists()) {
			file.createNewFile();
			raf = new RandomAccessFile(file, "rw");
			// ghi header
			raf.writeInt(0);
		} else {
			raf = new RandomAccessFile(file, "rw");
		}
	}

	private int locationCandidateById(int id) {
		int pointer = id * (4 + 50 + 50 + 100 + 100000) + 4;

		return pointer;
	}

	private char[] toCharArray(String str, int length) {
		char[] rs = new char[length];

		rs = str.toCharArray();

		return rs;
	}

	public boolean isValidAge(Candidate candidate) {
		return candidate.isValidAge();
	}

	public int register(Candidate candidate) throws IOException {
		int id;
		raf.seek(0);
		int size = raf.readInt();
		size++;
		raf.seek(0);
		raf.writeInt(size);
		id = size;

		char[] name = toCharArray(candidate.getName(), 25);
		char[] birth = toCharArray(candidate.getBirth(), 10);
		char[] address = toCharArray(candidate.getAddress(), 25);
		char[] fileImg = new byte[100000];
		raf.seek(locationCandidateById(id));
		
		return id;
	}

}
